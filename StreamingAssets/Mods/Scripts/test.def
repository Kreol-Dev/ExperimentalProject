locations_filler =
{
	scope = space.fit(places = 0)
	utility = 1
	action = 
	{
		space = 
		{
			size = 5
			repeat(random(1,4)) = 
			{
				generate(loc) = 
				{
					entity = 
					{
						position = vec(random(0, map_x), random(0, map_x))
					}
					place = 
					{
						size = random(1, 3)
					}
					markers =
					{
						set_marker = history_place
					}
					named = 
					{
						set("prefix", 0) = "Location of: "
						set("main_name", 1) = random_name(human_name)
					}
				}
				attach = loc.place
			}
		}
	}
}

named_ui = 
{
	scope = ui_object.markers.fit(showed_object.fit(has(named)) and not has_marker(named_ui_marker))
	utility = 1 
	action = 
	{
		markers.set_ui_marker = named_ui_marker
		ui_object = 
		{
			showed_named = showed_object.named
			create(text_field) = {
				show = showed_named.full_name
				showed_named.on_update = {
					show = showed_named.full_name
				}
				layout.min_height = 20
			}
		}
	}
}


agents_pool_filler = {
	scope = markers.place.fit(agents = 0 and has_marker(agents_pool))
	utility = 1
	action = {
		place = {
			size = 5
			repeat(random(1,4)) = {
				generate(ag) = {
					entity = yes
					agent = yes
					human = {
						age = random(20, 45)
					}
					named = {
						set("prefix", 0) = "Agent: "
						set("main_name", 1) = random_name(human_name)
					}
				}

				attach = ag.agent
			}
		}
	}
}

location_event = {
	scope = place.fit(not has(event_marker))
	utility = 1
	action = {
		create = event_marker
	}
}
agent_personality = {
	scope = agent.fit(not has(personality))
	utility = 1
	action = {
		create = personality
	}
}

aged_generation_add = {
	scope = human.fit(not has(aged_generation))
	utility = 1
	action = {
		create = aged_generation
	}
}

historical_persons = 
{
	scope = markers.lore.place.fit(agents = 0 and has_marker(lore_pool))
	utility = 1 
	action = 
	{
		place = {
			size = 10
			repeat(random(4,10)) = {
				generate(old_ag) = {
					entity = yes
					agent = yes
					historical_person = yes
					human = {
						age = random(30, 45)
					}
					named = {
						set("prefix", 0) = "Historical person: "
						set("main_name", 1) = random_name(human_name)
					}
				}

				attach = old_ag.agent
			}
		}
	}
}


location_log = 
{
	scope = place.named.fit(act = yes)
	utility = 0.3
	action  = 
	{
		log = named.get(main_name)
	}
}

destroy_self = 
{
	scope = entity.agent.fit(act = yes and not dead)
	utility = 0.01
	action = 
	{
		log = "Destroying self " + root
		destroy = root
	}
}

map_anchored = 
{
	scope = place.markers.fit(not has_marker(map_anchored) and has_marker(history_place))
	utility = 1
	action = {
		markers.set_ui_marker = map_anchored
		map_enlist = root
	}
}

encounter_ui_enlist = 
{
	scope = encounter.markers.fit(not has_marker(encounter_ui_enlist))
	utility = 1
	action = 
	{
		markers.set_ui_marker = encounter_ui_enlist
		enlist_encounter = root
	}
}

location_test_encounter = 
{
	scope = place.named.fit(act = yes)
	utility = 0.4
	action  = 
	{
		generate(enc) = 
		{
			encounter = 
			{
				context = root
			}
			markers = yes
			entity = yes
			named = 
			{
				set(main_name, 0) = "Basic encounter"
			}
		}
	}
}

place_ui_cards_list = 
{
	scope = ui_object.markers.fit(showed_object.fit(has(place)) and not has_marker (place_ui_cards_list))
	utility = 1
	action = 
	{
		markers.set_ui_marker = place_ui_cards_list
		pl = ui_object.showed_object.place
		spawn_prefab(place_cards) = 
		{
			agents_u_i.target_place = pl
			cards_holder_agents_adapter.target_place = pl
			set_parent(this) = root
		}
	}
}

place_ui_size = 
{
	once_per_object = yes
	scope = ui_object.markers.fit(showed_object.fit(has(place)))
	utility = 1
	action = 
	{
		create(text_field) = 
		{
			label = "size"
			show = ui_object.showed_object.place.size
			layout.min_height = 20
		}
	}
}